<Page x:Class="TelefonSatÄ±sApp.GelirGider"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Gelir Gider Raporu"
      Background="#111827">

    <Page.Resources>
        <SolidColorBrush x:Key="PrimaryBrush" Color="#2563EB"/>
        <SolidColorBrush x:Key="PrimaryDarkBrush" Color="#1E3A8A"/>
        <SolidColorBrush x:Key="CardBrush" Color="#1F2937"/>
        <SolidColorBrush x:Key="SurfaceBrush" Color="#0B1221"/>
        <SolidColorBrush x:Key="TextLight" Color="#E5E7EB"/>
        <SolidColorBrush x:Key="TextMuted" Color="#94A3B8"/>
        <SolidColorBrush x:Key="SuccessBrush" Color="#10B981"/>
        <SolidColorBrush x:Key="WarningBrush" Color="#F59E0B"/>
        <SolidColorBrush x:Key="ErrorBrush" Color="#EF4444"/>

        <!-- ScrollBar Stili -->
        <Style TargetType="ScrollBar">
            <Setter Property="Background" Value="#1E293B"/>
            <Setter Property="BorderBrush" Value="#374151"/>
            <Setter Property="Foreground" Value="#6B7280"/>
            <Setter Property="Width" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid>
                            <Border Background="{TemplateBinding Background}"
                                    CornerRadius="6"
                                    Margin="2"/>
                            <Track x:Name="PART_Track"
                                   IsDirectionReversed="True"
                                   Grid.Row="1">
                                <Track.Thumb>
                                    <Thumb>
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <Border Background="#4B5563"
                                                        CornerRadius="6"
                                                        Margin="2">
                                                    <Border.Style>
                                                        <Style TargetType="Border">
                                                            <Style.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Background" Value="#6B7280"/>
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Border.Style>
                                                </Border>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource TextLight}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource PrimaryDarkBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Converter -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        
        <!-- Sistem vurgularÄ±nÄ± koyu temaya Ã§ek -->
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#2563EB"/>
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="#E5E7EB"/>
        <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="#0F172A"/>
        <SolidColorBrush x:Key="{x:Static SystemColors.ControlTextBrushKey}" Color="#E5E7EB"/>

        <!-- ComboBox Ã¶ÄŸe stili: hover/seÃ§im renkleri belirgin -->
        <Style x:Key="ComboItemStyle" TargetType="ComboBoxItem">
            <Setter Property="Foreground" Value="{StaticResource TextLight}"/>
            <Setter Property="Background" Value="#0F172A"/>
            <Setter Property="Padding" Value="10,6"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1E293B"/>
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                    <Setter Property="Foreground" Value="{StaticResource TextLight}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- ComboBox -->
        <Style TargetType="ComboBox">
            <Style.Resources>
                <SolidColorBrush x:Key="{x:Static SystemColors.WindowBrushKey}" Color="#0F172A"/>
                <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="#0F172A"/>
                <SolidColorBrush x:Key="{x:Static SystemColors.WindowTextBrushKey}" Color="#E5E7EB"/>
                <SolidColorBrush x:Key="{x:Static SystemColors.ControlTextBrushKey}" Color="#E5E7EB"/>
            </Style.Resources>
            <Setter Property="Background" Value="#0F172A"/>
            <Setter Property="Foreground" Value="{StaticResource TextLight}"/>
            <Setter Property="BorderBrush" Value="#1E293B"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="ItemContainerStyle" Value="{StaticResource ComboItemStyle}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="20"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Ana border -->
                            <Border Grid.ColumnSpan="2"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="8"/>
                            
                            <!-- Editable TextBox -->
                            <TextBox x:Name="PART_EditableTextBox"
                                     Grid.Column="0"
                                     Background="Transparent"
                                     BorderThickness="0"
                                     Foreground="{StaticResource TextLight}"
                                     Padding="8,0"
                                     VerticalAlignment="Center"
                                     FontSize="{TemplateBinding FontSize}"
                                     Visibility="{Binding IsEditable, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            
                            <!-- Non-editable content -->
                            <ContentPresenter x:Name="ContentSite"
                                              Grid.Column="0"
                                              Content="{TemplateBinding SelectionBoxItem}"
                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                              Margin="8,0"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Left"
                                              IsHitTestVisible="False"/>
                            
                            <!-- Dropdown button -->
                            <ToggleButton x:Name="ToggleButton"
                                          Grid.Column="1"
                                          IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                          Focusable="False"
                                          ClickMode="Press"
                                          Background="Transparent"
                                          BorderThickness="0">
                                <Path Fill="{StaticResource TextLight}"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      Data="M 0 0 L 4 4 L 8 0 Z"/>
                            </ToggleButton>
                            
                            <!-- Popup -->
                            <Popup x:Name="Popup"
                                   Placement="Bottom"
                                   IsOpen="{TemplateBinding IsDropDownOpen}"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   StaysOpen="False">
                                <Border Background="#0F172A"
                                        BorderBrush="#1E293B"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Padding="4"
                                        MinWidth="{Binding ActualWidth, RelativeSource={RelativeSource TemplatedParent}}">
                                    <ScrollViewer>
                                        <ItemsPresenter/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                        
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
                                <Setter Property="BorderThickness" Value="2"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- BaÅŸlÄ±k -->
            <Border Grid.Row="0" Background="{StaticResource SurfaceBrush}" 
                    CornerRadius="12" Padding="20" Margin="0,0,0,20">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="ðŸ“Š" FontSize="24" Margin="0,0,12,0" VerticalAlignment="Center"/>
                    <StackPanel>
                        <TextBlock Text="Gelir Gider Raporu"
                                   Foreground="{StaticResource TextLight}"
                                   FontSize="20"
                                   FontWeight="Bold"/>
                        <TextBlock Text="AylÄ±k ve yÄ±llÄ±k finansal Ã¶zet"
                                   Foreground="{StaticResource TextMuted}"
                                   FontSize="14"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Filtre SeÃ§enekleri -->
            <Border Grid.Row="1" Background="{StaticResource CardBrush}" 
                    CornerRadius="12" Padding="20" Margin="0,0,0,20">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="DÃ¶nem:" 
                               Foreground="{StaticResource TextLight}" 
                               VerticalAlignment="Center" 
                               Margin="0,0,10,0"/>
                    
                    <ComboBox Grid.Column="1" x:Name="CbDonem" 
                              SelectionChanged="CbDonem_SelectionChanged"
                              DropDownClosed="CbDonem_DropDownClosed"
                              LostFocus="CbDonem_LostFocus"
                              KeyDown="ComboBox_KeyDown"
                              IsEditable="True"
                              IsTextSearchEnabled="True"
                              Margin="0,0,20,0">
                        <ComboBoxItem Content="Bu Ay" IsSelected="True"/>
                        <ComboBoxItem Content="Bu YÄ±l"/>
                        <ComboBoxItem Content="TÃ¼m Zamanlar"/>
                    </ComboBox>

                    <TextBlock Grid.Column="2" Text="YÄ±l:" 
                               Foreground="{StaticResource TextLight}" 
                               VerticalAlignment="Center" 
                               Margin="0,0,10,0"/>
                    
                    <ComboBox Grid.Column="3" x:Name="CbYil" 
                              SelectionChanged="CbYil_SelectionChanged"
                              DropDownClosed="CbYil_DropDownClosed"
                              LostFocus="CbYil_LostFocus"
                              KeyDown="ComboBox_KeyDown"
                              IsEditable="True"
                              IsTextSearchEnabled="True"
                              Margin="0,0,20,0"/>

                    <!-- Yenile ve Excel ButonlarÄ± -->
                    <StackPanel Grid.Column="5" Orientation="Horizontal">
                        <Button Click="YenileButton_Click"
                                Background="#0EA5E9"
                                Width="45" Height="40"
                                Margin="0,0,8,0"
                                ToolTip="Yenile">
                            <TextBlock Text="ðŸ”„" FontSize="16" Foreground="White"/>
                        </Button>
                        <Button Click="Button_ExcelExport"
                                Background="#22C55E"
                                Width="45" Height="40"
                                ToolTip="Excel'e Aktar">
                            <TextBlock Text="ðŸ“Š" FontSize="16" Foreground="White"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Ã–zet KartlarÄ± -->
            <Grid Grid.Row="2" Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Toplam Gelir -->
                <Border Grid.Column="0" Background="{StaticResource SuccessBrush}" 
                        CornerRadius="12" Padding="20" Margin="0,0,10,0">
                    <StackPanel>
                        <TextBlock Text="ðŸ’°" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                        <TextBlock Text="Toplam Gelir" 
                                   Foreground="White" 
                                   FontSize="14" 
                                   HorizontalAlignment="Center" 
                                   Margin="0,0,0,4"/>
                        <TextBlock x:Name="TxtToplamGelir" 
                                   Text="0 â‚º" 
                                   Foreground="White" 
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- Toplam Gider -->
                <Border Grid.Column="1" Background="{StaticResource ErrorBrush}" 
                        CornerRadius="12" Padding="20" Margin="5,0,5,0">
                    <StackPanel>
                        <TextBlock Text="ðŸ’¸" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                        <TextBlock Text="Toplam Gider" 
                                   Foreground="White" 
                                   FontSize="14" 
                                   HorizontalAlignment="Center" 
                                   Margin="0,0,0,4"/>
                        <TextBlock x:Name="TxtToplamGider" 
                                   Text="0 â‚º" 
                                   Foreground="White" 
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- Net Kar -->
                <Border Grid.Column="2" Background="{StaticResource PrimaryBrush}" 
                        CornerRadius="12" Padding="20" Margin="5,0,5,0">
                    <StackPanel>
                        <TextBlock Text="ðŸ“ˆ" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                        <TextBlock Text="Net Kar" 
                                   Foreground="White" 
                                   FontSize="14" 
                                   HorizontalAlignment="Center" 
                                   Margin="0,0,0,4"/>
                        <TextBlock x:Name="TxtNetKar" 
                                   Text="0 â‚º" 
                                   Foreground="White" 
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- SatÄ±ÅŸ Adedi -->
                <Border Grid.Column="3" Background="{StaticResource WarningBrush}" 
                        CornerRadius="12" Padding="20" Margin="10,0,0,0">
                    <StackPanel>
                        <TextBlock Text="ðŸ“±" FontSize="24" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                        <TextBlock Text="SatÄ±ÅŸ Adedi" 
                                   Foreground="White" 
                                   FontSize="14" 
                                   HorizontalAlignment="Center" 
                                   Margin="0,0,0,4"/>
                        <TextBlock x:Name="TxtSatisAdedi" 
                                   Text="0" 
                                   Foreground="White" 
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- DetaylÄ± Rapor -->
            <Border Grid.Row="3" Background="{StaticResource CardBrush}" 
                    CornerRadius="12" Padding="20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="DetaylÄ± Rapor" 
                               Foreground="{StaticResource TextLight}" 
                               FontSize="16" 
                               FontWeight="Bold" 
                               Margin="0,0,0,15"/>

                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Height="300">
                        <StackPanel x:Name="DetayliRaporPanel">
                            <!-- Dinamik iÃ§erik buraya eklenecek -->
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Border>


        </Grid>
    </ScrollViewer>
</Page>